<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <style>
        /* پیشرفت مراحل */
        .progress-container {
            display: flex;
            justify-content: space-between;
            margin: 20px 0;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
        }
        
        .progress-step {
            flex: 1;
            text-align: center;
            padding: 10px;
            border-radius: 5px;
            background: #e9ecef;
            margin: 0 5px;
            transition: all 0.3s;
        }
        
        .progress-step.completed {
            background: #4CAF50;
            color: white;
        }
        
        .progress-step.active {
            background: #2196F3;
            color: white;
        }

        /* استایل مراحل */
        .step {
            display: none;
            padding: 25px;
            border: 1px solid #dee2e6;
            border-radius: 10px;
            margin: 20px 0;
            background: white;
        }
        
        .step.active {
            display: block;
        }
        
        .step-title {
            font-size: 1.4em;
            color: #2c3e50;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #3498db;
        }

        /* استایل فیلدها */
        .input-group {
            margin: 25px 0;
        }
        
        label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: #34495e;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #bdc3c7;
            border-radius: 6px;
            margin: 8px 0;
            transition: border-color 0.3s;
        }
        
        textarea {
            height: 120px;
            resize: vertical;
        }
        
        input:focus, select:focus, textarea:focus {
            border-color: #3498db;
            outline: none;
        }

        /* دکمه‌ها */
        .button-group {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }
        
        button {
            padding: 12px 30px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .next-btn {
            background: #3498db;
            color: white;
        }
        
        .prev-btn {
            background: #95a5a6;
            color: white;
        }
        
        .submit-btn {
            background: #27ae60;
            color: white;
        }
        
        button:hover {
            opacity: 0.9;
        }
        
        #output {
            white-space: pre-wrap;
            padding: 25px;
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 10px;
            margin-top: 25px;
        }
    </style>
</head>
<body>
    <div class="progress-container" id="progress-container">
        <div class="progress-step active" data-step="1">مرحله ۱</div>
        <div class="progress-step" data-step="2">مرحله ۲</div>
        <div class="progress-step" data-step="3">مرحله ۳</div>
    </div>

    <div id="steps-container">
        <!-- Step 1 -->
        <div class="step active" data-step="1">
            <h2 class="step-title">مرحله اول: اطلاعات اصلی</h2>
            
            <div class="input-group">
                <label>نام کامل:</label>
                <input type="text" required>
            </div>
            
            <div class="input-group">
                <label>سن:</label>
                <input type="number" min="18" required>
            </div>
            
            <div class="input-group">
                <label>توضیحات تکمیلی:</label>
                <textarea required placeholder="متن خود را وارد کنید..."></textarea>
            </div>

            <div class="button-group">
                <button class="next-btn">مرحله بعد →</button>
            </div>
        </div>

        <!-- Step 2 -->
        <div class="step" data-step="2">
            <h2 class="step-title">مرحله دوم: جزئیات بیشتر</h2>
            
            <div class="input-group">
                <label>شماره تماس:</label>
                <input type="tel" pattern="09[0-9]{9}" required>
            </div>
            
            <div class="input-group">
                <label>نوع حساب:</label>
                <select required>
                    <option value="">انتخاب کنید</option>
                    <option value="حساب شخصی">شخصی</option>
                    <option value="حساب سازمانی">سازمانی</option>
                </select>
            </div>
            
            <div class="input-group">
                <label>پیام شما:</label>
                <textarea required placeholder="متن پیام..."></textarea>
            </div>

            <div class="button-group">
                <button class="prev-btn">← مرحله قبل</button>
                <button class="next-btn">مرحله بعد →</button>
            </div>
        </div>

        <!-- Step 3 -->
        <div class="step" data-step="3">
            <h2 class="step-title">مرحله سوم: نهایی سازی</h2>
            
            <div class="input-group">
                <label>آپلود مدارک:</label>
                <input type="file" multiple required>
            </div>
            
            <div class="input-group">
                <label>توضیحات نهایی:</label>
                <textarea required placeholder="توضیحات پایانی..."></textarea>
            </div>

            <div class="input-group">
                <label>
                    <input type="checkbox" required>
                    موافقت با قوانین و مقررات
                </label>
            </div>

            <div class="button-group">
                <button class="prev-btn">← مرحله قبل</button>
                <button class="submit-btn">ثبت نهایی</button>
            </div>
        </div>
    </div>

    <pre id="output"></pre>

    <script>
        const formData = [];
        let currentStep = 1;

        // مدیریت پیشرفت مراحل
        function updateProgress() {
            document.querySelectorAll('.progress-step').forEach(step => {
                const stepNumber = parseInt(step.dataset.step);
                step.classList.remove('active', 'completed');
                
                if (stepNumber < currentStep) {
                    step.classList.add('completed');
                } else if (stepNumber === currentStep) {
                    step.classList.add('active');
                }
            });
        }

        // اعتبارسنجی مراحل
        function validateStep(stepElement) {
            const inputs = stepElement.querySelectorAll('input, select, textarea');
            let isValid = true;

            inputs.forEach(input => {
                if (input.type === 'checkbox' && !input.checked) {
                    isValid = false;
                    input.parentElement.style.color = 'red';
                } else if (!input.checkValidity()) {
                    isValid = false;
                    input.style.borderColor = 'red';
                } else {
                    input.style.borderColor = '#bdc3c7';
                    if (input.type === 'checkbox') {
                        input.parentElement.style.color = 'inherit';
                    }
                }
            });

            if (!isValid) {
                alert('لطفا تمام فیلدهای ضروری را به درستی پر کنید');
            }
            return isValid;
        }

        // ذخیره داده‌ها
        function saveStepData(stepElement) {
            const data = {
                step: currentStep,
                fields: {}
            };

            stepElement.querySelectorAll('input, select, textarea').forEach(input => {
                const key = input.tagName.toLowerCase() + '-' + input.type;
                data.fields[key] = input.type === 'checkbox' ? input.checked : 
                                 input.type === 'file' ? [...input.files].map(f => f.name) :
                                 input.value;
            });

            formData[currentStep - 1] = data;
        }

        // مدیریت کلیک دکمه‌ها
        document.addEventListener('click', function(e) {
            const stepElement = e.target.closest('.step');
            
            if (e.target.classList.contains('next-btn')) {
                if (!validateStep(stepElement)) return;
                saveStepData(stepElement);
                currentStep++;
                navigateToStep(currentStep);
            }
            
            if (e.target.classList.contains('prev-btn')) {
                currentStep--;
                navigateToStep(currentStep);
            }
            
            if (e.target.classList.contains('submit-btn')) {
                if (!validateStep(stepElement)) return;
                saveStepData(stepElement);
                showResults();
                resetForm();
            }
        });

        // تغییر مراحل
        function navigateToStep(newStep) {
            document.querySelectorAll('.step').forEach(step => {
                step.classList.remove('active');
            });
            document.querySelector(`[data-step="${newStep}"]`).classList.add('active');
            updateProgress();
        }

        // نمایش نتایج
        function showResults() {
            const output = document.getElementById('output');
            output.innerHTML = JSON.stringify(formData, null, 4);
        }

        // ریست فرم
        function resetForm() {
            document.querySelectorAll('input, select, textarea').forEach(input => {
                if (input.type !== 'button') input.value = '';
                if (input.type === 'checkbox') input.checked = false;
                if (input.type === 'file') input.value = '';
            });
            currentStep = 1;
            formData.length = 0;
            navigateToStep(1);
        }
    </script>
</body>
</html>